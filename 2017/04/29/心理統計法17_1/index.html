<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>心理統計法(&#39;17) その１ | 統計ソフトRの備忘録２</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="放送大学「心理統計法(‘17)」第3章 第4章">
<meta property="og:type" content="article">
<meta property="og:title" content="心理統計法('17) その１">
<meta property="og:url" content="http://yoursite.com/2017/04/29/心理統計法17_1/">
<meta property="og:site_name" content="統計ソフトRの備忘録２">
<meta property="og:description" content="放送大学「心理統計法(‘17)」第3章 第4章">
<meta property="og:image" content="/images/bayes3_1.png">
<meta property="og:image" content="/images/bayes3_2.png">
<meta property="og:image" content="/images/bayes3_3.png">
<meta property="og:image" content="/images/bayes3_4.png">
<meta property="og:image" content="/images/bayes3_8.png">
<meta property="og:image" content="/images/bayes3_5.png">
<meta property="og:image" content="/images/bayes3_6.png">
<meta property="og:image" content="/images/bayes3_7.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="心理統計法('17) その１">
<meta name="twitter:description" content="放送大学「心理統計法(‘17)」第3章 第4章">

  
    <link rel="alternative" href="/atom.xml" title="統計ソフトRの備忘録２" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css" type="text/css">

  
<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">統計ソフトRの備忘録２</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="submit" value="&#xF002;" class="search-form-submit"><input type="hidden" name="q" value="site:http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-心理統計法17_1" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/04/29/心理統計法17_1/" class="article-date">
  <time datetime="2017-04-29T04:59:22.000Z" itemprop="datePublished">Apr 29 2017</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/放送大学/">放送大学</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      心理統計法(&#39;17) その１
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="放送大学「心理統計法(‘17)」第3章_第4章">放送大学「心理統計法(‘17)」第3章 第4章</h2>
<a id="more"></a>

<h4 id="授業ではrstanパッケージを使ってますが、MCMCpackパッケージを使ってみます。初学者ですので間違いが多々あると思います。">授業ではrstanパッケージを使ってますが、MCMCpackパッケージを使ってみます。初学者ですので間違いが多々あると思います。</h4>
<p>（Rスクリプトはここ）<br><a href="http://www.waseda.jp/sem-toyoda-lab/" target="_blank" rel="external">早稲田大学文学部文学研究科 豊田研究室 </a> </p>
<p>ダウンロードしてすべてのスクリプトを実行してみました。<br>(最初の結果が出るのに時間がかかりますが、結果を保存しておけば2回目からは快適です。）    </p>
<p> （参考）<br><a href="http://cse.ffpri.affrc.go.jp/hiroki/stat/mcmc_text.pdf" target="_blank" rel="external">ベイジアンMCMCによる統計モデル</a><br><a href="http://xavier-fim.net/packages/ggmcmc/" target="_blank" rel="external">Using the ggmcmc package</a><br><a href="http://rtokei.tech/stan/bayesian-inference-with-stan-%E7%95%AA%E5%A4%96%E7%B7%A8/" target="_blank" rel="external">Bayesian Inference With Stan ~番外編~ </a><br><a href="https://rstudio-pubs-static.s3.amazonaws.com/90036_f8a5dd14615b421b88e3ed49ecf745a9.html" target="_blank" rel="external">Exercise 2: Bayesian A/B testing using MCMC Metropolis-Hastings</a><br><a href="http://yukiyanai.github.io/jp/classes/rm1/contents/R/linear-regression-2.html" target="_blank" rel="external">政治学方法論 I</a></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">library(MCMCpack)</div><div class="line">library(ggmcmc)</div><div class="line">library(knitr)</div><div class="line"><span class="preprocessor">#表1.1の「知覚時間」のデータ入力</span></div><div class="line">x&lt;-c(<span class="number">31.43</span>,<span class="number">31.09</span>,<span class="number">33.38</span>,<span class="number">30.49</span>,<span class="number">29.62</span>,</div><div class="line">     <span class="number">35.40</span>,<span class="number">32.58</span>,<span class="number">28.96</span>,<span class="number">29.43</span>,<span class="number">28.52</span>,</div><div class="line">     <span class="number">25.39</span>,<span class="number">32.68</span>,<span class="number">30.51</span>,<span class="number">30.15</span>,<span class="number">32.33</span>,</div><div class="line">     <span class="number">30.43</span>,<span class="number">32.50</span>,<span class="number">32.07</span>,<span class="number">32.35</span>,<span class="number">31.57</span>)</div><div class="line"><span class="preprocessor">#MCMC推定に使用する関数を用意する。</span></div><div class="line"><span class="preprocessor">#betaは要素数2のベクトル。</span></div><div class="line"><span class="preprocessor">#beta[1]が平均、beta[2]が標準偏差で、betaを推定する。</span></div><div class="line"><span class="preprocessor">#関数の返り値は対数尤度。標準偏差は非負なので、0か負になったときは対数尤度をマイナス無限大とする。</span></div><div class="line"><span class="preprocessor">#</span></div><div class="line">llnormfun &lt;- function(beta, x) {</div><div class="line">	ifelse (beta[<span class="number">2</span>] &lt; <span class="number">0</span>, l&lt;- -Inf,</div><div class="line">		l &lt;- sum(log(dnorm(x, mean=beta[<span class="number">1</span>], sd=beta[<span class="number">2</span>]))))</div><div class="line">	<span class="keyword">return</span>(l)</div><div class="line">}</div></pre></td></tr></table></figure>

<h4 id="繰り返し3000回、初期値依存として捨てる数を0として、MCMC推定を実行。(_chain=5_)">繰り返し3000回、初期値依存として捨てる数を0として、MCMC推定を実行。( chain=5 )</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#fun:はサンプルを得るための関数</span></div><div class="line"><span class="comment">#theta.init:パラメータの初期値，(ここでは平均0、標準偏差30)</span></div><div class="line"><span class="comment">#burnin:初期値依存として捨てる部分である</span></div><div class="line"><span class="comment">#mcmc:サンプルを得る繰り返し回数，</span></div><div class="line"><span class="comment">#thin:サンプルを得る間隔（この例では1，すなわち毎回サンプルを得るようにしている），</span></div><div class="line"><span class="comment">#tune:はランダムウォークの大きさにかかわるパラメータ</span></div><div class="line"><span class="comment">#seed:疑似乱数のタネ</span></div><div class="line"><span class="comment">#</span></div><div class="line">post1 &lt;- MCMCmetrop1R(llnormfun, theta.<span class="variable">init =</span> c(<span class="number">0</span>, <span class="number">30</span>), <span class="variable">x =</span> x, <span class="variable">mcmc =</span> <span class="number">3000</span>, <span class="variable">burnin=</span><span class="number">0</span>,<span class="variable">seed =</span><span class="number">1</span>)</div><div class="line">post2 &lt;- MCMCmetrop1R(llnormfun, theta.<span class="variable">init =</span> c(<span class="number">0</span>, <span class="number">30</span>), <span class="variable">x =</span> x, <span class="variable">mcmc =</span> <span class="number">3000</span>, <span class="variable">burnin=</span><span class="number">0</span>,<span class="variable">seed =</span><span class="number">2</span>)</div><div class="line">post3 &lt;- MCMCmetrop1R(llnormfun, theta.<span class="variable">init =</span> c(<span class="number">0</span>, <span class="number">30</span>), <span class="variable">x =</span> x, <span class="variable">mcmc =</span> <span class="number">3000</span>, <span class="variable">burnin=</span><span class="number">0</span>,<span class="variable">seed =</span><span class="number">3</span>)</div><div class="line">post4 &lt;- MCMCmetrop1R(llnormfun, theta.<span class="variable">init =</span> c(<span class="number">0</span>, <span class="number">30</span>), <span class="variable">x =</span> x, <span class="variable">mcmc =</span> <span class="number">3000</span>, <span class="variable">burnin=</span><span class="number">0</span>,<span class="variable">seed =</span><span class="number">4</span>)</div><div class="line">post5 &lt;- MCMCmetrop1R(llnormfun, theta.<span class="variable">init =</span> c(<span class="number">0</span>, <span class="number">30</span>), <span class="variable">x =</span> x, <span class="variable">mcmc =</span> <span class="number">3000</span>, <span class="variable">burnin=</span><span class="number">0</span>,<span class="variable">seed =</span><span class="number">5</span>)</div><div class="line"><span class="comment">#</span></div><div class="line">geweke.diag(post1)</div><div class="line"><span class="comment">#|Z| &gt; 1.96のとき危険率5%で差がある。（定常状態に達していない。）</span></div></pre></td></tr></table></figure>

<p>Fraction in 1st window = 0.1<br>Fraction in 2nd window = 0.5   </p>
<p>  var1   var2<br>-2.792 18.457   </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">posterior <span class="subst">&lt;-</span> mcmc<span class="built_in">.</span><span class="built_in">list</span>(post1, post2, post3, post4, post5)</div><div class="line"><span class="variable">#png</span>(<span class="string">"bayes3_1.png"</span>)</div><div class="line">plot(posterior, trace <span class="subst">=</span> <span class="literal">TRUE</span>, density <span class="subst">=</span> <span class="literal">TRUE</span>)</div><div class="line"><span class="variable">#dev.off</span>()</div></pre></td></tr></table></figure>

<p><img src="/images/bayes3_1.png" alt=""></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="title">summary</span><span class="params">(posterior)</span></span></div></pre></td></tr></table></figure>

<p>Iterations = 1:3000<br>Thinning interval = 1<br>Number of chains = 5<br>Sample size per chain = 3000   </p>
<ol>
<li><p>Empirical mean and standard deviation for each variable,<br>plus standard error of the mean:  </p>
<p>Mean    SD Naive SE Time-series SE<br>[1,] 27.648 7.722  0.06305          1.738<br>[2,]  7.023 9.127  0.07452          2.810  </p>
</li>
<li><p>Quantiles for each variable:  </p>
<p>2.5%    25%    50%   75% 97.5%<br>[1,] 2.491 30.085 30.862 31.27 32.09<br>[2,] 1.694  2.097  2.403  4.37 30.10  </p>
</li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="transposed_variable">gelman.</span><span class="built_in">diag</span>(posterior)</div></pre></td></tr></table></figure>

<p>Potential scale reduction factors:  </p>
<p>   Point est. Upper C.I.<br>[1,]       1.01       1.01<br>[2,]       1.01       1.03  </p>
<p>Multivariate psrf  </p>
<p>1.01  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="title">effectiveSize</span><span class="params">(posterior)</span></span></div></pre></td></tr></table></figure>

<p>   var1     var2<br>28.46518 11.41829  </p>
<h5 id="1500回くらいまでは収束していない。（rstanはずっと早く収束する）">1500回くらいまでは収束していない。（rstanはずっと早く収束する）</h5>
<h5 id="effectiveSizeも3000回＊５＝１５０００回で28_、_１１">effectiveSizeも3000回＊５＝１５０００回で28 、 １１</h5>
<h4 id="繰り返し20000回、初期値依存として捨てる数を2000として、MCMC推定を実行。(_chain=5_)">繰り返し20000回、初期値依存として捨てる数を2000として、MCMC推定を実行。( chain=5 )</h4>
<h4 id="lapply()関数を使ってプログラムを短く">lapply()関数を使ってプログラムを短く</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">chains  &lt;- 1<span class="value">:<span class="number">5</span></span></div><div class="line">seeds  &lt;- <span class="function">seq</span>(<span class="number">1</span>,<span class="number">5</span>,<span class="number">1</span>)</div><div class="line">posterior2  &lt;- <span class="function">lapply</span>(chains ,</div><div class="line">			<span class="function">function</span>(chain) {</div><div class="line">				<span class="function">MCMCmetrop1R</span>(fun = llnormfun ,</div><div class="line">				theta.init = <span class="function">c</span>(<span class="number">0</span>,<span class="number">30</span>),</div><div class="line">				burnin = <span class="number">2000</span>,  mcmc = <span class="number">20000</span>,</div><div class="line">				seed = seeds[chain],thin=<span class="number">1</span>,</div><div class="line">				x = x)})</div><div class="line"><span class="hexcolor">#c</span><span class="function">lass</span>(posterior2)</div><div class="line">#<span class="function">str</span>(posterior2)</div><div class="line">#geweke.<span class="function">diag</span>(posterior2[[<span class="number">1</span>]])</div><div class="line">post2.mcmc &lt;- mcmc.<span class="function">list</span>(posterior2)</div><div class="line">#<span class="function">png</span>(<span class="string">"bayes3_2.png"</span>)</div><div class="line"><span class="function">plot</span>(post2.mcmc, trace = TRUE, density = TRUE)</div><div class="line"><span class="hexcolor">#de</span>v.<span class="function">off</span>()</div></pre></td></tr></table></figure>

<p><img src="/images/bayes3_2.png" alt=""></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="title">summary</span><span class="params">(post2.mcmc)</span></span></div></pre></td></tr></table></figure>

<p>Iterations = 2001:22000<br>Thinning interval = 1<br>Number of chains = 5<br>Sample size per chain = 20000   </p>
<ol>
<li><p>Empirical mean and standard deviation for each variable,<br>plus standard error of the mean:  </p>
<p>Mean     SD Naive SE Time-series SE<br>[1,] 31.028 0.5133 0.001623       0.005449<br>[2,]  2.274 0.4033 0.001275       0.005282  </p>
</li>
<li><p>Quantiles for each variable:  </p>
<p>2.5%    25%    50%    75%  97.5%<br>[1,] 29.999 30.696 31.031 31.361 32.034<br>[2,]  1.652  1.991  2.221  2.495  3.216  </p>
</li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="transposed_variable">gelman.</span><span class="built_in">diag</span>(<span class="transposed_variable">post2.</span>mcmc)</div></pre></td></tr></table></figure>

<p>Potential scale reduction factors:  </p>
<p>   Point est. Upper C.I.<br>[1,]          1          1<br>[2,]          1          1  </p>
<p>Multivariate psrf  </p>
<p>1</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="title">effectiveSize</span><span class="params">(post2.mcmc)</span></span></div></pre></td></tr></table></figure>

<p>   var1     var2<br>8876.217 5971.989   </p>
<h5 id="effectiveSize_:_20000回＊5=100000回で8876,_5972">effectiveSize : 20000回＊5=100000回で8876, 5972</h5>
<h4 id="繰り返し200000回、初期値依存として捨てる数を2000、thin（サンプルを得る間隔）=10として、MCMC推定を実行。(_chain=5_)">繰り返し200000回、初期値依存として捨てる数を2000、thin（サンプルを得る間隔）=10として、MCMC推定を実行。( chain=5 )</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">chains  &lt;- <span class="number">1</span>:<span class="number">5</span></div><div class="line">seeds  &lt;- seq(<span class="number">1</span>,<span class="number">5</span>,<span class="number">1</span>)</div><div class="line">posterior3  &lt;- lapply(chains ,</div><div class="line">			function(chain) {</div><div class="line">				MCMCmetrop1R(<span class="variable">fun =</span> llnormfun ,</div><div class="line">				theta.<span class="variable">init =</span> c(<span class="number">0</span>,<span class="number">30</span>),</div><div class="line">				<span class="variable">burnin =</span> <span class="number">2000</span>,  <span class="variable">mcmc =</span> <span class="number">200000</span>,</div><div class="line">				<span class="variable">seed =</span> seeds[chain],<span class="variable">thin=</span><span class="number">10</span>,</div><div class="line">				<span class="variable">x =</span> x)})</div><div class="line">post3.mcmc &lt;- mcmc.list(posterior3)</div><div class="line"><span class="comment">#png("bayes3_3.png")</span></div><div class="line">plot(post3.mcmc, <span class="variable">trace =</span> TRUE, <span class="variable">density =</span> TRUE)</div><div class="line"><span class="comment">#dev.off()</span></div></pre></td></tr></table></figure>

<p><img src="/images/bayes3_3.png" alt=""></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="title">summary</span><span class="params">(post3.mcmc)</span></span></div></pre></td></tr></table></figure>

<p>Iterations = 2001:201991<br>Thinning interval = 10<br>Number of chains = 5<br>Sample size per chain = 20000   </p>
<ol>
<li><p>Empirical mean and standard deviation for each variable,<br>plus standard error of the mean:  </p>
<p>Mean     SD Naive SE Time-series SE<br>[1,] 31.047 0.5173 0.001636       0.001998<br>[2,]  2.275 0.4048 0.001280       0.001768  </p>
</li>
<li><p>Quantiles for each variable:  </p>
<p>2.5%   25%    50%   75%  97.5%<br>[1,] 30.028 30.71 31.045 31.38 32.078<br>[2,]  1.647  1.99  2.219  2.50  3.222  </p>
</li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="transposed_variable">gelman.</span><span class="built_in">diag</span>(<span class="transposed_variable">post3.</span>mcmc)</div></pre></td></tr></table></figure>

<p>Potential scale reduction factors:  </p>
<p>   Point est. Upper C.I.<br>[1,]          1          1<br>[2,]          1          1  </p>
<p>Multivariate psrf  </p>
<p>1  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="title">effectiveSize</span><span class="params">(post3.mcmc)</span></span></div></pre></td></tr></table></figure>

<p>   var1     var2<br>67206.95 52591.34  </p>
<h5 id="effectiveSize_:_20000回＊5=100000回で67207_,_52591">effectiveSize : 20000回＊5=100000回で67207 ,  52591</h5>
<h5 id="ほぼテキスト並の数値になったので以後はこの出力を使う">ほぼテキスト並の数値になったので以後はこの出力を使う</h5>
<h4 id="xasteは、推定されたsigma_を使って正規分布から無作為に抽出する必要がある。">xasteは、推定されたsigma を使って正規分布から無作為に抽出する必要がある。</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="title">df</span> &lt;- <span class="typedef"><span class="keyword">data</span>.frame<span class="container">(<span class="title">mu</span>=<span class="title">unlist</span>(<span class="title">post3</span>.<span class="title">mcmc</span>[,1])</span>,sigma=unlist<span class="container">(<span class="title">post3</span>.<span class="title">mcmc</span>[,2])</span>)</span></div><div class="line"><span class="title">xaste</span>&lt;-rnorm(n = nrow(df), mean =df$mu, sd = df$sigma)</div><div class="line"><span class="preprocessor">#</span></div><div class="line"><span class="title">df</span>&lt;- <span class="typedef"><span class="keyword">data</span>.frame<span class="container">(<span class="title">df</span>,<span class="title">xaste</span>)</span></span></div><div class="line"><span class="preprocessor">#</span></div><div class="line"><span class="preprocessor"># kanitr::kableを使って出力を工夫</span></div><div class="line"><span class="preprocessor">#</span></div><div class="line"><span class="title">ryou</span>&lt;-<span class="typedef"><span class="keyword">data</span>.frame<span class="container">(<span class="title">c</span>(<span class="title">round</span>(<span class="title">mean</span>(<span class="title">df</span>[,1])</span>,2) , round<span class="container">(<span class="title">sd</span>(<span class="title">df</span>[,1])</span>,2) ,</span></div><div class="line">	round(quantile(df[,<span class="number">1</span>],c(<span class="number">0.025</span>,<span class="number">0.05</span>,<span class="number">0.5</span>,<span class="number">0.95</span>,<span class="number">0.975</span>)),<span class="number">2</span>)))</div><div class="line"><span class="title">for</span> (i <span class="keyword">in</span> <span class="number">2</span>:ncol(df) ){</div><div class="line"><span class="title">ryou</span>&lt;-cbind(ryou,<span class="typedef"><span class="keyword">data</span>.frame<span class="container">(<span class="title">c</span>(<span class="title">round</span>(<span class="title">mean</span>(<span class="title">df</span>[,<span class="title">i</span>])</span>,2) , round<span class="container">(<span class="title">sd</span>(<span class="title">df</span>[,<span class="title">i</span>])</span>,2) ,</span></div><div class="line">	round(quantile(df[,i],c(<span class="number">0.025</span>,<span class="number">0.05</span>,<span class="number">0.5</span>,<span class="number">0.95</span>,<span class="number">0.975</span>)),<span class="number">2</span>))))</div><div class="line">}</div><div class="line"><span class="title">names</span>(ryou)&lt;-c(<span class="string">"mu"</span>,<span class="string">"sigma"</span>,<span class="string">"xaste"</span>)</div><div class="line"><span class="title">rownames</span>(ryou)&lt;-c(<span class="string">"EAP"</span>,<span class="string">"post.sd"</span>,<span class="string">"2.5%"</span>,<span class="string">"5%"</span>,<span class="string">"50%"</span>,<span class="string">"95%"</span>,<span class="string">"97.5%"</span>)</div><div class="line"><span class="preprocessor">#</span></div><div class="line"><span class="title">kable</span>(t(ryou))</div></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th style="text-align:left"></th>
<th style="text-align:right">EAP</th>
<th style="text-align:right">post.sd</th>
<th style="text-align:right">2.5%</th>
<th style="text-align:right">5%</th>
<th style="text-align:right">50%</th>
<th style="text-align:right">95%</th>
<th style="text-align:right">97.5%</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">mu</td>
<td style="text-align:right">31.05</td>
<td style="text-align:right">0.52</td>
<td style="text-align:right">30.03</td>
<td style="text-align:right">30.20</td>
<td style="text-align:right">31.04</td>
<td style="text-align:right">31.90</td>
<td style="text-align:right">32.08</td>
</tr>
<tr>
<td style="text-align:left">sigma</td>
<td style="text-align:right">2.28</td>
<td style="text-align:right">0.40</td>
<td style="text-align:right">1.65</td>
<td style="text-align:right">1.72</td>
<td style="text-align:right">2.22</td>
<td style="text-align:right">3.02</td>
<td style="text-align:right">3.22</td>
</tr>
<tr>
<td style="text-align:left">xaste</td>
<td style="text-align:right">31.04</td>
<td style="text-align:right">2.36</td>
<td style="text-align:right">26.37</td>
<td style="text-align:right">27.18</td>
<td style="text-align:right">31.04</td>
<td style="text-align:right">34.89</td>
<td style="text-align:right">35.70</td>
</tr>
</tbody>
</table>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">#png</span>(<span class="comment">"bayes3_4.png"</span>)</div><div class="line">hist(df<span class="char">$x</span>aste,breaks=<span class="number">100</span>,main=<span class="comment">"事後予測分布"</span>)</div><div class="line"><span class="symbol">#abline</span>(v=mean(df<span class="char">$x</span>aste),col=<span class="comment">"red"</span>)</div><div class="line">segments(mean(df<span class="char">$x</span>aste),<span class="number">0</span>,mean(df<span class="char">$x</span>aste),par(<span class="comment">"usr"</span>)[<span class="number">4</span>],lwd=<span class="number">2.5</span> ,col=<span class="comment">"red"</span>)</div><div class="line"><span class="symbol">#dev</span>.off()</div></pre></td></tr></table></figure>

<p><img src="/images/bayes3_4.png" alt=""></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"># 確率密度関数（dnorm）<span class="value">: 確率分布関数（pnorm）とその逆関数（qnorm）</span></div><div class="line">x&lt;<span class="function">-seq</span>(<span class="number">20</span>,<span class="number">45</span>,<span class="number">0.1</span>)</div><div class="line">#<span class="function">png</span>(<span class="string">"bayes3_8.png"</span>)</div><div class="line"><span class="function">par</span>(mfrow=<span class="function">c</span>(<span class="number">3</span>,<span class="number">1</span>))</div><div class="line"><span class="function">curve</span>(<span class="function">dnorm</span>(x,<span class="number">31.04</span>,<span class="number">2.27</span>),<span class="number">20</span>,<span class="number">45</span>, col=<span class="string">"blue"</span>)</div><div class="line"><span class="function">title</span>(main=<span class="string">"正規分布\n(平均:31.04 / 標準偏差:2.27)"</span>)</div><div class="line"><span class="function">curve</span>(<span class="function">dnorm</span>(x,<span class="number">31.04</span>,<span class="number">2.22</span>),<span class="number">20</span>,<span class="number">45</span>, col=<span class="string">"red"</span>)</div><div class="line"><span class="function">title</span>(main=<span class="string">"正規分布\n(平均:31.04 / 標準偏差:2.22)"</span>)</div><div class="line"><span class="function">curve</span>(<span class="function">dnorm</span>(x,<span class="number">31.04</span>,<span class="number">2.07</span>),<span class="number">20</span>,<span class="number">45</span>, col=<span class="string">"green"</span>)</div><div class="line"><span class="function">title</span>(main=<span class="string">"正規分布\n(平均:31.04 / 標準偏差:2.07)"</span>)</div><div class="line"><span class="function">par</span>(mfrow=<span class="function">c</span>(<span class="number">1</span>,<span class="number">1</span>))</div><div class="line"><span class="hexcolor">#de</span>v.<span class="function">off</span>()</div></pre></td></tr></table></figure>

<p><img src="/images/bayes3_8.png" alt=""></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">library(ggmcmc)</div><div class="line"><span class="preprocessor">#ggmcmc(ggs(post3.mcmc), file="posterior.pdf")</span></div><div class="line"><span class="preprocessor">#ggmcmc(ggs(post3.mcmc), plot=c("histogram", "traceplot", "geweke"))</span></div><div class="line"><span class="preprocessor">#ggmcmc(ggs(post3.mcmc), plot=c("histogram"),file=NULL)</span></div><div class="line"><span class="preprocessor">#ggs_histogram(ggs(post3.mcmc))</span></div><div class="line"><span class="preprocessor">#ggs_density(ggs(post3.mcmc))</span></div><div class="line"><span class="preprocessor">#ggs_traceplot(ggs(post3.mcmc))</span></div><div class="line"><span class="preprocessor">#ggs_running(ggs(post3.mcmc))</span></div><div class="line"><span class="preprocessor">#ggs_compare_partial(ggs(post3.mcmc))</span></div><div class="line"><span class="preprocessor">#ggs_autocorrelation(ggs(post3.mcmc))</span></div><div class="line"><span class="preprocessor">#ggs_crosscorrelation(ggs(post3.mcmc))</span></div><div class="line"><span class="preprocessor">#ggs_Rhat(ggs(post3.mcmc)) + xlab("R_hat")</span></div><div class="line"><span class="preprocessor">#ggs_geweke(ggs(post3.mcmc))</span></div><div class="line"><span class="preprocessor">#</span></div><div class="line"><span class="preprocessor">#png("bayes3_5.png",width=800,height=600)</span></div><div class="line">p1&lt;-ggs_traceplot(ggs(post3.mcmc))</div><div class="line">p2&lt;-ggs_running(ggs(post3.mcmc))</div><div class="line">p3&lt;-ggs_compare_partial(ggs(post3.mcmc))</div><div class="line">p4&lt;-ggs_autocorrelation(ggs(post3.mcmc))</div><div class="line">p5&lt;-ggs_geweke(ggs(post3.mcmc))</div><div class="line">gridExtra::grid.arrange(p1, p2, p3, p4, p5,ncol = <span class="number">2</span>)</div><div class="line"><span class="preprocessor">#dev.off()</span></div></pre></td></tr></table></figure>

<p><img src="/images/bayes3_5.png" alt=""></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">#png("bayes3_6.png",width=800,height=600)</span></div><div class="line"><span class="title">p1</span>&lt;-ggs_histogram(ggs(post3.mcmc))</div><div class="line"><span class="title">p2</span>&lt;-ggs_density(ggs(post3.mcmc))</div><div class="line"><span class="title">p3</span>&lt;-ggs_crosscorrelation(ggs(post3.mcmc))</div><div class="line"><span class="title">p4</span>&lt;-ggs_Rhat(ggs(post3.mcmc)) + xlab(<span class="string">"R_hat"</span>)</div><div class="line"><span class="title">gridExtra</span>::grid.arrange(p1, p2, p3, p4,ncol = <span class="number">2</span>)</div><div class="line"><span class="preprocessor">#dev.off()</span></div></pre></td></tr></table></figure>

<p><img src="/images/bayes3_6.png" alt=""></p>
<h3 id="p-61_生成量の推定結果">p.61 生成量の推定結果</h3>
<h4 id="分散">分散</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">variance &lt;- df$sigma^<span class="number">2</span></div><div class="line">c(EAP=<span class="built_in">round</span>(mean(variance),<span class="number">3</span>) , <span class="built_in">post</span>.sd=<span class="built_in">round</span>(sd(variance),<span class="number">3</span>) ,</div><div class="line">	<span class="built_in">round</span>(quantile(variance,c(<span class="number">0.025</span>,<span class="number">0.05</span>,<span class="number">0.5</span>,<span class="number">0.95</span>,<span class="number">0.975</span>)),<span class="number">3</span>))</div></pre></td></tr></table></figure>

<p>   EAP post.sd    2.5%      5%     50%     95%   97.5%<br>  5.340   2.018   2.712   2.964   4.922   9.102  10.378   </p>
<h4 id="変動係数">変動係数</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cv&lt;- df$sigma/df$mu</div><div class="line">c(EAP=<span class="built_in">round</span>(mean(cv),<span class="number">3</span>) , <span class="built_in">post</span>.sd=<span class="built_in">round</span>(sd(cv),<span class="number">3</span>) ,</div><div class="line">	<span class="built_in">round</span>(quantile(cv,c(<span class="number">0.025</span>,<span class="number">0.05</span>,<span class="number">0.5</span>,<span class="number">0.95</span>,<span class="number">0.975</span>)),<span class="number">3</span>))</div></pre></td></tr></table></figure>

<p>   EAP post.sd    2.5%      5%     50%     95%   97.5%<br>  0.073   0.013   0.053   0.055   0.071   0.097   0.104   </p>
<h4 id="効果量">効果量</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">c</span>&lt;-<span class="number">30</span></div><div class="line">delta30&lt;- (df$mu-<span class="built_in">c</span>)/df$sigma</div><div class="line"><span class="built_in">c</span>(<span class="type">EAP</span>=round(mean(delta30),<span class="number">3</span>) , post.sd=round(sd(delta30),<span class="number">3</span>) ,</div><div class="line">	round(quantile(delta30,<span class="built_in">c</span>(<span class="number">0.025</span>,<span class="number">0.05</span>,<span class="number">0.5</span>,<span class="number">0.95</span>,<span class="number">0.975</span>)),<span class="number">3</span>))</div></pre></td></tr></table></figure>

<p>   EAP post.sd    2.5%      5%     50%     95%   97.5%<br>  0.474   0.237   0.012   0.085   0.473   0.865   0.939   </p>
<h4 id="分位点・％点">分位点・％点</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">z&lt;-qnorm(<span class="number">0.25</span>, <span class="variable">mean=</span><span class="number">0</span>, <span class="variable">sd=</span><span class="number">1</span>)</div><div class="line">qu25&lt;- df$mu + z * df$sigma</div><div class="line">c(<span class="variable">EAP=</span>round(mean(qu25),<span class="number">3</span>) , post.<span class="variable">sd=</span>round(sd(qu25),<span class="number">3</span>) ,</div><div class="line">	round(quantile(qu25,c(<span class="number">0.025</span>,<span class="number">0.05</span>,<span class="number">0.5</span>,<span class="number">0.95</span>,<span class="number">0.975</span>)),<span class="number">3</span>))</div></pre></td></tr></table></figure>

<p>   EAP post.sd    2.5%      5%     50%     95%   97.5%<br> 29.513   0.583  28.246  28.495  29.552  30.390  30.540  </p>
<h4 id="特定区間での観測確率">特定区間での観測確率</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">u29.<span class="number">5</span>_30.<span class="number">5</span>&lt;-pnorm(<span class="number">30.5</span>, <span class="variable">mean =</span>df$mu, <span class="variable">sd =</span> df$sigma)-pnorm(<span class="number">29.5</span>, <span class="variable">mean =</span>df$mu, <span class="variable">sd =</span> df$sigma)</div><div class="line">c(<span class="variable">EAP=</span>round(mean(u29.<span class="number">5</span>_30.<span class="number">5</span>),<span class="number">3</span>) , post.<span class="variable">sd=</span>round(sd(u29.<span class="number">5</span>_30.<span class="number">5</span>),<span class="number">3</span>) ,</div><div class="line">	round(quantile(u29.<span class="number">5</span>_30.<span class="number">5</span>,c(<span class="number">0.025</span>,<span class="number">0.05</span>,<span class="number">0.5</span>,<span class="number">0.95</span>,<span class="number">0.975</span>)),<span class="number">3</span>))</div></pre></td></tr></table></figure>

<p>   EAP post.sd    2.5%      5%     50%     95%   97.5%<br>  0.156   0.026   0.106   0.114   0.155   0.201   0.210   </p>
<h4 id="比の分布">比の分布</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">c</span>&lt;-<span class="number">30</span></div><div class="line">hi30&lt;-df$xaste/<span class="built_in">c</span></div><div class="line"><span class="built_in">c</span>(<span class="type">EAP</span>=round(mean(hi30),<span class="number">3</span>) , post.sd=round(sd(hi30),<span class="number">3</span>) ,</div><div class="line">	round(quantile(hi30,<span class="built_in">c</span>(<span class="number">0.025</span>,<span class="number">0.05</span>,<span class="number">0.5</span>,<span class="number">0.95</span>,<span class="number">0.975</span>)),<span class="number">3</span>))</div></pre></td></tr></table></figure>

<p>   EAP post.sd    2.5%      5%     50%     95%   97.5%<br>  1.035   0.079   0.879   0.906   1.035   1.163   1.190   </p>
<h3 id="各種事後分布">各種事後分布</h3>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#png("bayes3_7.png",width=800,height=600)</span></div><div class="line">par(<span class="variable">mfrow=</span>c(<span class="number">2</span>,<span class="number">3</span>))</div><div class="line">hist(variance,<span class="variable">breaks=</span><span class="number">100</span>,<span class="variable">main=</span><span class="string">"分散"</span>)</div><div class="line">hist(cv,<span class="variable">breaks=</span><span class="number">100</span>,<span class="variable">main=</span><span class="string">"変動係数"</span>)</div><div class="line">hist(delta30,<span class="variable">breaks=</span><span class="number">100</span>,<span class="variable">main=</span><span class="string">"効果量"</span>)</div><div class="line">hist(qu25,<span class="variable">breaks=</span><span class="number">100</span>,<span class="variable">main=</span><span class="string">"２５％点"</span>)</div><div class="line">hist(u29.<span class="number">5</span>_30.<span class="number">5</span>,<span class="variable">breaks=</span><span class="number">100</span>,<span class="variable">main=</span><span class="string">"U29.5 &lt; xaste &lt; 30.5"</span>)</div><div class="line">hist(hi30,<span class="variable">breaks=</span><span class="number">100</span>,<span class="variable">main=</span><span class="string">"xaste / 30"</span>)</div><div class="line">par(<span class="variable">mfrow=</span>c(<span class="number">1</span>,<span class="number">1</span>))</div><div class="line"><span class="comment">#dev.off()</span></div></pre></td></tr></table></figure>

<p><img src="/images/bayes3_7.png" alt=""></p>
<h3 id="研究仮説が正しい確率">研究仮説が正しい確率</h3>
<h4 id="30&lt;mu">30&lt;mu</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="input"><span class="prompt">p&lt;-table(df$mu &gt;</span> <span class="number">30</span>) </span></div><div class="line">p[<span class="number">2</span>]/(p[<span class="number">1</span>]+p[<span class="number">2</span>])</div></pre></td></tr></table></figure>

<p>  TRUE<br>0.9778   </p>
<h4 id="29-5&lt;mu&lt;30-5">29.5&lt;mu&lt;30.5</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="input"><span class="prompt">p&lt;-table(df$xaste &gt;</span> <span class="number">29.5</span> & df<span class="variable">$xaste</span> &lt; <span class="number">30.5</span>) </span></div><div class="line">p[<span class="number">2</span>]/(p[<span class="number">1</span>]+p[<span class="number">2</span>])</div></pre></td></tr></table></figure>

<p>   TRUE<br>0.15509   </p>
<h4 id="delta30_&gt;_0-5">delta30 &gt; 0.5</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="input"><span class="prompt">p&lt;-table(delta30 &gt;</span> <span class="number">0</span>.<span class="number">5</span>) </span></div><div class="line">p[<span class="number">2</span>]/(p[<span class="number">1</span>]+p[<span class="number">2</span>])</div></pre></td></tr></table></figure>

<p>   TRUE<br>0.45327   </p>
<h4 id="29-5_&lt;_測定値_&lt;_30-5_の確率が20%未満の確率">29.5 &lt; 測定値 &lt; 30.5 の確率が20%未満の確率</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">p&lt;- <span class="built_in">table</span>(u29<span class="number">.5</span>_30<span class="number">.5</span> &lt; <span class="number">0.2</span>)</div><div class="line">p[<span class="number">2</span>]/(p[<span class="number">1</span>]+p[<span class="number">2</span>])</div></pre></td></tr></table></figure>

<p>   TRUE<br>0.94793    </p>
<h2 id="本格的にやるには「rstan」でしょうけど、ベイズ統計初学者には「rstan」より「MCMCpack」の方がとっつきやすいのでは。">本格的にやるには「rstan」でしょうけど、ベイズ統計初学者には「rstan」より「MCMCpack」の方がとっつきやすいのでは。</h2>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/04/29/心理統計法17_1/" data-id="1tw5ew3agw4jfnsk" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/心理統計法/">心理統計法</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/05/03/心理統計法17_2/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          心理統計法(&#39;17) その2
        
      </div>
    </a>
  
  
    <a href="/2017/01/08/日銀買入額20170106/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">日銀買入額(2010-12-15～2017-01-07)</div>
    </a>
  
</nav>

  
</article>



<a href="http://yoursite.com/2017/04/29/心理統計法17_1/">
  <img src="https://ga-beacon.appspot.com/UA-67242781-1/2017/04/29/心理統計法17_1/?pixel" /></a>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CAD/">CAD</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/GMT/">GMT</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Gambit/">Gambit</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Gnumeric/">Gnumeric</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Graphviz/">Graphviz</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/NetworkX/">NetworkX</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/R/">R</a><span class="category-list-count">80</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ggplot2/">ggplot2</a><span class="category-list-count">15</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/plot/">plot</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/sqlite3/">sqlite3</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/グラフまとめ/">グラフまとめ</a><span class="category-list-count">14</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/地震/">地震</a><span class="category-list-count">14</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/放送大学/">放送大学</a><span class="category-list-count">49</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/21世紀の資本/">21世紀の資本</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Graphviz/">Graphviz</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HEXO/">HEXO</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OpenSCAD/">OpenSCAD</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Rパッケージ/">Rパッケージ</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/アメリカ地質調査所/">アメリカ地質調査所</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/オープンデータ/">オープンデータ</a><span class="tag-list-count">24</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/グラフ/">グラフ</a><span class="tag-list-count">14</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/データからの知識発見/">データからの知識発見</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/データベース/">データベース</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/原因をさぐる統計学/">原因をさぐる統計学</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/問題解決の数理/">問題解決の数理</a><span class="tag-list-count">21</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/因子分析＆確証的因子分析/">因子分析＆確証的因子分析</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/地図/">地図</a><span class="tag-list-count">24</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/地震の年表/">地震の年表</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/心理・教育統計法特論/">心理・教育統計法特論</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/心理統計法/">心理統計法</a><span class="tag-list-count">17</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/成長曲線モデル/">成長曲線モデル</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/時系列解析/">時系列解析</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/気象庁地震カタログ/">気象庁地震カタログ</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/気象庁地震情報/">気象庁地震情報</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/気象庁震源リスト/">気象庁震源リスト</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/潜在変数間の因果関係/">潜在変数間の因果関係</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/生活に関するデータ等/">生活に関するデータ等</a><span class="tag-list-count">15</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/震源メカニズム/">震源メカニズム</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/震源リスト/">震源リスト</a><span class="tag-list-count">3</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/21世紀の資本/" style="font-size: 12.31px;">21世紀の資本</a><a href="/tags/Graphviz/" style="font-size: 10.00px;">Graphviz</a><a href="/tags/HEXO/" style="font-size: 10.77px;">HEXO</a><a href="/tags/OpenSCAD/" style="font-size: 10.00px;">OpenSCAD</a><a href="/tags/Rパッケージ/" style="font-size: 10.77px;">Rパッケージ</a><a href="/tags/アメリカ地質調査所/" style="font-size: 13.85px;">アメリカ地質調査所</a><a href="/tags/オープンデータ/" style="font-size: 20.00px;">オープンデータ</a><a href="/tags/グラフ/" style="font-size: 16.92px;">グラフ</a><a href="/tags/データからの知識発見/" style="font-size: 14.62px;">データからの知識発見</a><a href="/tags/データベース/" style="font-size: 11.54px;">データベース</a><a href="/tags/原因をさぐる統計学/" style="font-size: 15.38px;">原因をさぐる統計学</a><a href="/tags/問題解決の数理/" style="font-size: 19.23px;">問題解決の数理</a><a href="/tags/因子分析＆確証的因子分析/" style="font-size: 10.00px;">因子分析＆確証的因子分析</a><a href="/tags/地図/" style="font-size: 20.00px;">地図</a><a href="/tags/地震の年表/" style="font-size: 10.00px;">地震の年表</a><a href="/tags/心理・教育統計法特論/" style="font-size: 13.08px;">心理・教育統計法特論</a><a href="/tags/心理統計法/" style="font-size: 18.46px;">心理統計法</a><a href="/tags/成長曲線モデル/" style="font-size: 10.00px;">成長曲線モデル</a><a href="/tags/時系列解析/" style="font-size: 10.77px;">時系列解析</a><a href="/tags/気象庁地震カタログ/" style="font-size: 16.15px;">気象庁地震カタログ</a><a href="/tags/気象庁地震情報/" style="font-size: 10.00px;">気象庁地震情報</a><a href="/tags/気象庁震源リスト/" style="font-size: 11.54px;">気象庁震源リスト</a><a href="/tags/潜在変数間の因果関係/" style="font-size: 10.00px;">潜在変数間の因果関係</a><a href="/tags/生活に関するデータ等/" style="font-size: 17.69px;">生活に関するデータ等</a><a href="/tags/震源メカニズム/" style="font-size: 10.00px;">震源メカニズム</a><a href="/tags/震源リスト/" style="font-size: 11.54px;">震源リスト</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05">May 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04">April 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01">January 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11">November 2016</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10">October 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09">September 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06">June 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05">May 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04">April 2016</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03">March 2016</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02">February 2016</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01">January 2016</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10">October 2015</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09">September 2015</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08">August 2015</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07">July 2015</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06">June 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05">May 2015</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04">April 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03">March 2015</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/02">February 2015</a><span class="archive-list-count">35</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11">November 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/10">October 2014</a><span class="archive-list-count">18</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09">September 2014</a><span class="archive-list-count">34</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/05/05/心理統計法17_3/">心理統計法(&#39;17) その3</a>
          </li>
        
          <li>
            <a href="/2017/05/03/心理統計法17_2/">心理統計法(&#39;17) その2</a>
          </li>
        
          <li>
            <a href="/2017/04/29/心理統計法17_1/">心理統計法(&#39;17) その１</a>
          </li>
        
          <li>
            <a href="/2017/01/08/日銀買入額20170106/">日銀買入額(2010-12-15～2017-01-07)</a>
          </li>
        
          <li>
            <a href="/2016/11/26/震源地と原子力発電所09/">震源地と原子力発電所(世界その５)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 統計ソフトRの備忘録２<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">

  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>



<script src="/js/script.js" type="text/javascript"></script>

  </div>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>